<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Тестовая страничка для вебпанели</title>

	<link rel="stylesheet" href="/css/oktell-panel.css"/>

	<script type="text/javascript" src="/jslib/vendor/jquery-1.9.1.js"></script>
	<script type="text/javascript" src="/jslib/vendor/oktell-1.5.0.js"></script>
	<script type="text/javascript" src="/jslib/jqueryPlugins/iScroll.js"></script>


	<script type="text/javascript" src="/coffee/utils.js"></script>
	<!--<script type="text/javascript" src="/coffee/koBindings/hoverSelect.js"></script>-->
	<!--<script type="text/javascript" src="/coffee/koBindings/inputClear.js"></script>-->
	<!--<script type="text/javascript" src="/coffee/koBindings/jScroll.js"></script>-->
	<!--<script type="text/javascript" src="/coffee/class/ActionList.js"></script>-->
	<!--<script type="text/javascript" src="/coffee/class/Panel.js"></script>-->
	<!--<script type="text/javascript" src="/coffee/class/User.js"></script>-->
	<!--<script type="text/javascript" src="/coffee/class/UsersService.js"></script>-->
	<script type="text/javascript" src="/coffee/class/List.js"></script>
	<script type="text/javascript" src="/coffee/class/CUser.js"></script>
	<script type="text/javascript" src="/coffee/jScroll.js"></script>


	<script type="text/javascript">
		window.oktell = new Oktell
	</script>

	<script type="text/javascript" src="/coffee/oktell-panel.js"></script>

	<script type="text/javascript">
		$(function(){
			var stateEl = $('#connectionState');
			stateEl.text('Соединение');
			var oktell = window.oktell

			oktell.on('disconnect', function(reason){
				stateEl.text('Ошибка')
			});

			var statesLogel = $('#webstate')
			oktell.on('statusChange', function(newS, oldS){
				var d = new Date();
				statesLogel.append( '<p>Cтатус = "' + newS + '", предыдущий статус = "' + oldS + '", время смены ' + d.getHours()+':'+ d.getMinutes()+':'+ d.getSeconds() + '</p>' );
			});

			oktell.connect({
				//url: ['213.239.200.141'],
				url: ['192.168.0.61'],
				login: 'a3',
				password: 'a3',
				debugMode: true,
				openTimeout: 5000,
				webSocketSwfLocation: '/jslib/vendor/WebSocketMain.swf',
				expires: 84600,
				queryTimeout: 5000,
				queueInterval: 999999,
//				defaultAvatar: '/img/noavatar.png',
//				defaultAvatar32x32: '/img/noavatar.png',
//				defaultAvatar64x64: '/img/noavatar.png',
				callback: function(data) {
					if ( data.result ) {
						stateEl.text('Онлайн')
						oktell.trigger('oktellConnected')
					} else {
						stateEl.text('Ошибка')
					}
				}
			});

			$('.setStatus').click(function(){ oktell.setStatus($(this).data('status'), false, 'break message')});

			$.oktellPanel({
				oktell: oktell,
				dynamic: true,
				position: 'right',
				debug: true
			});
			$('.userPhone').oktellButton()
		});
	</script>

</head>
<body>
	<div style="width: 500px; height: 500px;">
		<style type="text/css">
			.userPhone {
				float: right;
				display: inline-block;
			}
			.user {
				width: 200px;
				padding-bottom: 10px;
			}
		</style>
		<span>Статус:</span> <span id="connectionState">Соединение</span><br>
		<button class="setStatus" data-status="ready">set Ready</button><br>
		<button class="setStatus" data-status="dnd">set DND</button><br>
		<button class="setStatus" data-status="redirect">set Redirect</button><br>
		<button class="setStatus" data-status="break">set Break with text</button><br>
		<div id="webstate"></div><br>
		<p class="user">Дмитрий Е. 103<span class="userPhone" data-phone="103"></span></p>
		<p class="user">Алексей В. 101<span class="userPhone" data-phone="101"></span></p>
		102 <span class="userPhone" data-phone="102"></span><br>
		104 <span class="userPhone" data-phone="104"></span><br>
		105 <span class="userPhone" data-phone="105"></span><br>
		106 <span class="userPhone" data-phone="106"></span><br>

		<br>
		<br>
		Вид кнопок
		<div>
			Call
			<ul class="b_button_action m_button_action_call">
				<li class="g_first">
					<i></i>
				</li>
				<li class="g_last drop_down">
					<i></i>
				</li>
			</ul><br>
			<br>
			Conference
			<ul class="b_button_action m_button_action_conference">
				<li class="g_first">
					<i></i>
				</li>
				<li class="g_last drop_down">
					<i></i>
				</li>
			</ul><br>
			<br>
			transfer
			<ul class="b_button_action m_button_action_transfer">
				<li class="g_first">
					<i></i>
				</li>
				<li class="g_last drop_down">
					<i></i>
				</li>
			</ul><br>
			<br>
			toggle
			<ul class="b_button_action m_button_action_toggle">
				<li class="g_first">
					<i></i>
				</li>
				<li class="g_last drop_down">
					<i></i>
				</li>
			</ul><br>
			<br>
			intercom
			<ul class="b_button_action m_button_action_intercom">
				<li class="g_first">
					<i></i>
				</li>
				<li class="g_last drop_down">
					<i></i>
				</li>
			</ul><br>
			<br>
			endCall
			<ul class="b_button_action m_button_action_endcall">
				<li class="g_first">
					<i></i>
				</li>
				<li class="g_last drop_down">
					<i></i>
				</li>
			</ul><br>
			<br>
			ghostListen
			<ul class="b_button_action m_button_action_ghostlisten">
				<li class="g_first">
					<i></i>
				</li>
				<li class="g_last drop_down">
					<i></i>
				</li>
			</ul><br>
			<br>
			ghostHelp
			<ul class="b_button_action m_button_action_ghosthelp">
				<li class="g_first">
					<i></i>
				</li>
				<li class="g_last drop_down">
					<i></i>
				</li>
			</ul><br>
			<br>
            <ul style="z-index: 999; padding: 0px; font-size: 13px; font-family: Tahoma; top: 80px; left: 500px; visibility: visible; display: inline-block" class="b_actions_group_list">
                <li class="i_call g_first" data-bind="click: $parent.doActionByClick, css: $data.css, hoverSelect: true" data-action="call">
                    <i></i>
                    <span data-bind="text: a.text">Позвонить</span>
                </li>

                <li class="i_conference" data-bind="click: $parent.doActionByClick, css: $data.css, hoverSelect: true" data-action="conference">
                    <i></i>
                    <span data-bind="text: a.text">Конференция</span>
                </li>

                <li class="i_intercom" data-bind="click: $parent.doActionByClick, css: $data.css, hoverSelect: true" data-action="intercom">
                    <i></i>
                    <span data-bind="text: a.text">Интерком</span>
                </li>

                <li class="i_toggle" data-bind="click: $parent.doActionByClick, css: $data.css, hoverSelect: true" data-action="intercom">
                    <i></i>
                    <span data-bind="text: a.text">toggle</span>
                </li>

                <li class="i_transfer" data-bind="click: $parent.doActionByClick, css: $data.css, hoverSelect: true" data-action="intercom">
                    <i></i>
                    <span data-bind="text: a.text">transfer</span>
                </li>

                <li class="i_endcall" data-bind="click: $parent.doActionByClick, css: $data.css, hoverSelect: true" data-action="intercom">
                    <i></i>
                    <span data-bind="text: a.text">endcall</span>
                </li>

                <li class="i_ghostlisten" data-bind="click: $parent.doActionByClick, css: $data.css, hoverSelect: true" data-action="intercom">
                    <i></i>
                    <span data-bind="text: a.text">ghostlisten</span>
                </li>

                <li class="i_ghosthelp g_last" data-bind="click: $parent.doActionByClick, css: $data.css, hoverSelect: true" data-action="intercom">
                    <i></i>
                    <span data-bind="text: a.text">ghosthelp</span>
                </li>
            </ul>

		</div>
	</div>
    <div class="l_popup" style="display: none">
        <div class="l_popup_content">
            <div class="b_popup_box" style="display: block;">
                <div class="h_padding">
                    <i class="o_close"></i>
                    <h1>Входящий вызов</h1>
                    <div class="b_comming_call_user">
                        <div class="h_padding">
                            <table>
                                <tbody data-cont="call_popup">

                                </tbody>
                            </table>
                        </div>
                    </div>
                    <a class="btn m_big close_action" href="#" style="float: right;">Скрыть</a>
                    <a class="btn m_big m_button_green" href="#" style="margin-right: 20px; float: left; display: none;"><i></i>Ответить</a>
                    <a class="btn m_big m_button_red j_abort_action" href="#"><i></i>Отклонить</a>
                </div>
            </div>
        </div>
    </div>
</body>
</html>